{% extends 'base.html' %}

{% block container %}

    <div class="box">
        <h2> {{ deckTitle }}</h2>
    </div>
    
    <div id="card" class="card">
        <h3 id="next-question"> START </h3>
    </div>

    <button id="add-card-button" class="button2" >Add Card</button>
    <button id="edit-card-button" class="button2">Edit</button>

    <form method="post" id="card-form" style="display:none">
        <textarea name="question"></textarea>
        <button class="button2">Done</button>
    </form>


    <script>
        const nextQuestion = document.querySelector("#next-question");
        const card = document.querySelector("#card");
        var cardIndex = 0;
        var questions = '{{ cardList }}'
        questions = questions.replaceAll("&#39;","\"")
        var cardList = Array.from(JSON.parse(questions))
        cardList.push("END OF DECK")
        card.addEventListener("click", function() {
            nextQuestion.textContent = cardList[cardIndex];
            if (cardIndex < cardList.length-1) {
                cardIndex += 1;
            }
        });

        const username = "{{ username }}"
        const deckTitle = "{{ deckTitle }}"
        
        const addButton = document.querySelector("#add-card-button")
        addButton.addEventListener("click", async function() {
            document.querySelector("#next-question").style.display="none"
            document.querySelector("#add-card-button").style.display="none"
            document.querySelector("#edit-card-button").style.display="none"
            document.querySelector("#card-form").style.display="initial"

            document.querySelector("#card-form").action="/" + username + "/" + deckTitle + "/" + cardIndex + "/add"
        })

        const editButton = document.querySelector("#edit-card-button")
        editButton.addEventListener("click", function() {
            console.log("cardIndex: ", cardIndex)
        })
    </script>

{% endblock %}

