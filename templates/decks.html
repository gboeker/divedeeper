{% extends 'base.html' %}

{% block container %}

    <div class="search-container">
        <input type="text" id="searchBar" placeholder="Search decks...">
    </div>

    {% for deck in mainDecks %}
        <a href="{{ url_for('displayDeck', username='guest', deckTitle=deck.title )}}" style="text-decoration:none" class="deck-link">
            <div class="main-deck">
                <h3>{{ deck.title }}</h3>
            </div>
        </a>
    {% endfor %}

    {% for deck in personalDecks %}
        <a href="{{ url_for('displayDeck', username=username, deckTitle=deck.title) }}" style="text-decoration:none" class="deck-link">
            <div class="personal-deck" >
                <form action="{{ url_for('deleteDeck', username=username, deckTitle=deck.title) }}" method="post">
                    <input type="hidden" name="username" value="{{ username }}">
                    <input type="hidden" name="deckTitle" value="{{ deck.title }}">
                    <button type="submit" class="delete-deck">X</button>
                </form>
                <h3>{{ deck.title }}</h3>
            </div>
        </a>
    {% endfor %}

    <script>
        const searchBar = document.getElementById("searchBar");
        const deckLinks = document.querySelectorAll(".deck-link");

        searchBar.addEventListener("input", function() {
            const searchTerm = searchBar.value.toLowerCase();
            deckLinks.forEach(function(link) {
                const deckTitle = link.querySelector("h3").textContent.toLowerCase();
                if (deckTitle.includes(searchTerm)) {
                    link.style.display = "block";
                } else {
                    link.style.display = "none";
                }
            });
        });
    </script>

    {% if isAuth %} 

        <form action="{{ url_for('createDeck', username=username) }}" method="post" id="add-deck-form" class="personal-deck" style="display: none">
            <div class="vertical-align">
                <p>CANCEL</p>
                <input type="text" name="title" placeholder="Type..." required>
                <input class="user-input" type="submit" name="create" value="CREATE DECK" />
            </div>
        </form>
        
        <div class="add-deck">
            <h3> + </h3>
        </div>

        <script>
            const addDeck = document.querySelector(".add-deck")
            addDeck.addEventListener("click", function() {
                document.querySelector("#add-deck-form").style.display="flex"
            })
            const exitAddDeck = document.querySelector("#add-deck-form p")
            exitAddDeck.addEventListener("click", function() {
                document.querySelector("#add-deck-form").style.display="none"
            })
        </script>

    {% endif %}


{% endblock %}

