{% extends 'base.html' %}

{% block container %}

    <div class="search-container">
        <input type="text" id="searchBar" placeholder="Search decks...">
    </div>

    {% for deck in mainDecks %}
        <a href="{{ url_for('displayDeck', username='guest', deckTitle=deck.title )}}" style="text-decoration:none" class="deck-link">
            <div class="main-deck">
                <h3>{{ deck.title }}</h3>
            </div>
        </a>
    {% endfor %}
   
    {% for deck in personalDecks %}
        <a href="{{ url_for('displayDeck', username=username, deckTitle=deck.title) }}" style="text-decoration:none" class="deck-link">
            <div class="personal-deck" >
                <object>
                    <a href="{{ url_for('deleteDeck', username=username, deckTitle=deck.title) }}" class="icon-top-left">
                        <span class="fa-stack fa-4x">
                            <i class="fa-solid fa-circle fa-stack-2x " style="color:#eae1df"></i>
                            <i class="fa-regular fa-trash-can fa-stack-1x fa-inverse " style="color:#382c2b"></i>
                        </span>
                    </a>
                </object>
                <h3>{{ deck.title }}</h3>
            </div>
        </a>
    {% endfor %}

    <button onclick="document.getElementById('id01').style.display='block'">Open Modal</button>

    <div id="id01" class="modal">
        <span onclick="document.getElementById('id01').style.display='none'" class="close" title="Close Modal">&times;</span>
        <form class="modal-content" action="/action_page.php">
            <div class="modal-container">
                <h3>Delete Deck</h3>
                <img class="frog-image" src="/static/images/are_you_shore_frog.png" alt="are_you_shore_frog.png">
                <button type="button" class="button">Cancel</button>
                <button type="button" class="button2">Delete</button>
            </div>
        </form>
    </div>

    <!-- script to have modal close upon click outside -->
    <script>
        // Get the modal
        var modal = document.getElementById('id01');
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
          if (event.target == modal) {
            modal.style.display = "none";
          }
        }
    </script>

    <script>
        const searchBar = document.getElementById("searchBar");
        const deckLinks = document.querySelectorAll(".deck-link");

        searchBar.addEventListener("input", function() {
            const searchTerm = searchBar.value.toLowerCase();
            deckLinks.forEach(function(link) {
                const deckTitle = link.querySelector("h3").textContent.toLowerCase();
                if (deckTitle.includes(searchTerm)) {
                    link.style.display = "block";
                } else {
                    link.style.display = "none";
                }
            });
        });
    </script>

    {% if isAuth %} 

        <form action="{{ url_for('createDeck', username=username) }}" class="personal-deck" method="post" id="add-deck-form" style="display: none">
            <div id="close-icon" class="icon-top-left">
                <span class="fa-stack fa-4x">
                    <i class="fa-solid fa-circle fa-stack-2x " style="color:#eae1df"></i>
                    <i class="fa-solid fa-xmark fa-stack-1x" style="color:#382c2b"></i>
                </span>
            </div>
            <input type="text" name="title" placeholder="Type..." required>
            <input class="user-input" type="submit" name="create" value="CREATE DECK" />
        </form>
        
        <div class="add-deck">
            <h3> + </h3>
        </div>

        <script>
            const addDeck = document.querySelector(".add-deck")
            addDeck.addEventListener("click", function() {
                document.querySelector("#add-deck-form").style.display="flex"
            })
            const exitAddDeck = document.querySelector("#add-deck-form #close-icon")
            exitAddDeck.addEventListener("click", function() {
                document.querySelector("#add-deck-form").style.display="none"
            })
        </script>

    {% endif %}

{% endblock %}

